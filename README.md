# Offline RAG Chatbot

This project implements an offline Retrieval Augmented Generation (RAG) chatbot. It allows users to ask questions about a local collection of documents and receive answers generated by a language model, with supporting context retrieved from those documents. The system is designed to run entirely locally, without needing internet access for its core operations once models and data are set up.

## Features

* **Offline Operation:** All models (embedding, language model, NLP tools) are loaded locally.
* **Document Ingestion:** Supports reading and processing `.txt`, `.pdf`, and `.docx` files.
* **Vector-Based Retrieval:**
    * Uses SentenceTransformers (`all-MiniLM-L6-v2`) to generate embeddings for document chunks.
    * Builds a FAISS index for efficient similarity search.
* **Language Model Integration:**
    * Utilizes a locally stored ONNX-optimized Flan-T5 base model (`flan-t5-base_onnx`) for answer generation.
    * Supports CPU or CUDA execution for the LLM.
* **Advanced Query Processing:**
    * **Question Classification:** Identifies query types (e.g., factual, descriptive, advantages, disadvantages) to tailor prompts and retrieval.
    * **Query Expansion:** Uses NLTK WordNet and spaCy to expand queries with synonyms for potentially better retrieval.
    * **Context Filtering:** Selects relevant chunks for the LLM based on similarity, keyword matching, and extracted entities.
* **MCQ Handling:** Includes heuristics to identify and group Multiple Choice Question content from documents for more precise factual answering.
* **Caching for Performance:**
    * Uses `shelve` (Python's persistent dictionary) to cache document chunk embeddings, speeding up index building on subsequent runs.
    * Caches LLM-generated answers, significantly improving response times for repeated queries.
* **Graphical User Interface (GUI):**
    * Built with Tkinter (via `ui_gui.py`).
    * Displays retrieved context chunks alongside the chat.
    * Allows users to click on source information to open the original document.
* **NLP Utilities:** Leverages NLTK for WordNet and spaCy (`en_core_web_sm`) for lemmatization and part-of-speech tagging.

